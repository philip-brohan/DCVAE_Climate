<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Default model &#8212; An ML Climate Model based on a DCVAE</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxdoc.css?v=87629129" />
    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Default model fixed structure" href="VAE.html" />
    <link rel="prev" title="A Machine Learning Climate Model based on a Deep Convolutional Variational AutoEncoder" href="../index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="VAE.html" title="Default model fixed structure"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../index.html" title="A Machine Learning Climate Model based on a Deep Convolutional Variational AutoEncoder"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DCVAE-Climate</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Default model</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="default-model">
<h1>Default model<a class="headerlink" href="#default-model" title="Link to this heading">¶</a></h1>
<p>The model is a Deep Convolutional <a class="reference external" href="https://en.wikipedia.org/wiki/Variational_autoencoder">Variational Autoencoder</a>. It takes <a class="reference internal" href="make_dataset.html"><span class="doc">input data</span></a> on a 721x1440 grid (same as ERA5), and uses a pair of convolutional neural nets to encode and decode the data - learning to both produce a target output on the same grid and make the encoded version (the embedding) distributed as a unit normal. The <a class="reference internal" href="VAE.html"><span class="doc">structure of the model</span></a> (12 convolutional layers in the encoder, 11 in the decoder) is fixed, but input and output data, and the hyperparameters (learning rate, batch size, beta, etc) can be changed. They are set in a <a class="reference internal" href="specify.html"><span class="doc">specification file</span></a>.</p>
<figure class="align-center" id="id2" style="width: 95%">
<a class="reference internal image-reference" href="../_images/Slide3.PNG"><img alt="../_images/Slide3.PNG" src="../_images/Slide3.PNG" style="width: 95%;" /></a>
<figcaption>
<p><span class="caption-text">The structure of the VAE used to train the generator</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>The model structure and data flows are defined in files that should not need modification:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="VAE.html">Model structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="make_dataset.html">Input Datasets</a></li>
</ul>
</div>
<p>To run the model, we need to specify the model inputs, outputs and hyperparameters. This is done in a specification file. Copy the specification file and the model training script to a new directory, and edit the specification file to suit your needs. Then run the training script.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="specify.html">Specification file</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Training script</a></li>
</ul>
</div>
<p>And to test the training success there are scripts for plotting the training history and for testing the model on a test dataset.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="plot_history.html">Plot training_history</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">Validate on single month</a></li>
<li class="toctree-l1"><a class="reference internal" href="validate_multi.html">Validate on time-series</a></li>
</ul>
</div>
<p>We are using a <a class="reference external" href="https://en.wikipedia.org/wiki/Variational_autoencoder">Variational Autoencoder</a>, because we want to be able to <a class="reference external" href="https://brohan.org/Proxy_20CR">assimilate data into it</a>.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="assimilation.html">Assimilate a single month</a></li>
<li class="toctree-l1"><a class="reference internal" href="assimilate_multi.html">Assimilate a time-series</a></li>
</ul>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/DCVAE_Climate.webp" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Detailed specification of the ML model</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_data/index.html">How to download the training data</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../normalization/index.html">How to convert and normalize the data</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="specify.html">Specify the details of the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="make_dataset.html">Assemble the normalized data into training and test datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Train the model</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">Utility functions for plotting and regridding</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../how_to.html">How to reproduce or extend this work</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Authors and acknowledgements</a></li>
</ul>
<h3><a href="https://github.com/philip-brohan/DCVAE_Climate">Get a copy</a></h3>

<ul>
    <li><a href="https://github.com/philip-brohan/DCVAE_Climate" rel="nofollow">Github repository</a></li>
</ul>

<h3>Found a bug, or have a suggestion?</h3>

Please <a href="https://github.com/philip-brohan/DCVAE_Climate/issues/new">raise an issue</a>.
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="VAE.html" title="Default model fixed structure"
             >next</a> |</li>
        <li class="right" >
          <a href="../index.html" title="A Machine Learning Climate Model based on a Deep Convolutional Variational AutoEncoder"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DCVAE-Climate</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Default model</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    </div>
  </body>
</html>