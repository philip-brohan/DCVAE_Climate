Search.setIndex({"alltitles": {"A DIY Machine Learning Climate Model": [[16, "a-diy-machine-learning-climate-model"]], "Appendices": [[16, "appendices"]], "Assemble ERA5 normalized data into a set of tf.tensors": [[19, "assemble-era5-normalized-data-into-a-set-of-tf-tensors"]], "Assemble ERA5 raw data into a set of tf.tensors": [[20, "assemble-era5-raw-data-into-a-set-of-tf-tensors"]], "Authors and acknowledgements": [[10, "authors-and-acknowledgements"]], "Background": [[16, "background"]], "Check gamma distributions for ERA5 data": [[23, "check-gamma-distributions-for-era5-data"]], "Check gamma parameters for ERA5 data": [[21, "check-gamma-parameters-for-era5-data"]], "Check normalization of ERA5 data": [[22, "check-normalization-of-era5-data"]], "Conclusions": [[16, "conclusions"]], "Default model": [[3, "default-model"]], "Default model - assimilate test data for a single month into trained model": [[2, "default-model-assimilate-test-data-for-a-single-month-into-trained-model"]], "Default model - make time-series by assimilating all test months into trained model": [[1, "default-model-make-time-series-by-assimilating-all-test-months-into-trained-model"]], "Default model - plot training history": [[5, "default-model-plot-training-history"]], "Default model - validate trained model on test data for a single month": [[9, "default-model-validate-trained-model-on-test-data-for-a-single-month"]], "Default model - validate trained model on time-series of all test months": [[8, "default-model-validate-trained-model-on-time-series-of-all-test-months"]], "Default model fixed structure": [[0, "default-model-fixed-structure"]], "Default model training script": [[7, "default-model-training-script"]], "Define a standard grid": [[24, "define-a-standard-grid"]], "Design Decisions": [[16, "design-decisions"]], "ERA5 data download and access": [[12, "era5-data-download-and-access"]], "Estimate normalization parameters for ERA5 data": [[17, "estimate-normalization-parameters-for-era5-data"]], "Generic model specification file": [[6, "generic-model-specification-file"]], "Get the data to be used": [[13, "get-the-data-to-be-used"]], "How to reproduce and extend this work": [[15, "how-to-reproduce-and-extend-this-work"]], "Land mask download": [[14, "land-mask-download"]], "Make the tf.data.Dataset inputs and outputs for the DCVAE": [[4, "make-the-tf-data-dataset-inputs-and-outputs-for-the-dcvae"]], "Next steps": [[16, "next-steps"]], "Normalizing training data": [[18, "normalizing-training-data"]], "Plotting utilities": [[26, "plotting-utilities"]], "Setting up the software environment": [[11, "setting-up-the-software-environment"]], "Small print": [[16, "small-print"]], "Training data": [[16, "training-data"]], "Training the model": [[16, "training-the-model"]], "Using as a generative model": [[16, "using-as-a-generative-model"]], "Utility functions for plotting and re-gridding": [[25, "utility-functions-for-plotting-and-re-gridding"]], "Validating the trained model": [[16, "validating-the-trained-model"]]}, "docnames": ["ML_default/VAE", "ML_default/assimilate_multi", "ML_default/assimilation", "ML_default/index", "ML_default/make_dataset", "ML_default/plot_history", "ML_default/specify", "ML_default/training", "ML_default/validate_multi", "ML_default/validation", "credits", "environment", "get_data/ERA5", "get_data/index", "get_data/land_mask", "how_to", "index", "normalization/estimate_parameters", "normalization/index", "normalization/make_normalized_tensors", "normalization/make_raw_tensors", "normalization/validate_for_fields", "normalization/validate_for_month", "normalization/validate_for_points", "utils/grids", "utils/index", "utils/plots"], "envversion": {"sphinx": 61, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1}, "filenames": ["ML_default/VAE.rst", "ML_default/assimilate_multi.rst", "ML_default/assimilation.rst", "ML_default/index.rst", "ML_default/make_dataset.rst", "ML_default/plot_history.rst", "ML_default/specify.rst", "ML_default/training.rst", "ML_default/validate_multi.rst", "ML_default/validation.rst", "credits.rst", "environment.rst", "get_data/ERA5.rst", "get_data/index.rst", "get_data/land_mask.rst", "how_to.rst", "index.rst", "normalization/estimate_parameters.rst", "normalization/index.rst", "normalization/make_normalized_tensors.rst", "normalization/make_raw_tensors.rst", "normalization/validate_for_fields.rst", "normalization/validate_for_month.rst", "normalization/validate_for_points.rst", "utils/grids.rst", "utils/index.rst", "utils/plots.rst"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [0, 1, 2, 4, 5, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 26], "0": [0, 1, 2, 4, 5, 6, 7, 8, 9, 11, 12, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26], "00": [12, 14], "000": 6, "00001": 19, "01": [1, 2, 5, 8, 9, 12, 21], "02": [12, 21, 22], "02d": [1, 2, 4, 5, 8, 9, 17, 19, 20, 21, 23], "03": [12, 14, 22, 23], "04": 12, "04d": [0, 1, 2, 4, 5, 7, 8, 9, 12, 19, 20], "05": [6, 12, 22, 23], "05d": 4, "06": 12, "07": [1, 2, 5, 8, 9, 12], "08": 12, "09": 12, "0e": [17, 19], "1": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26], "10": [0, 1, 2, 5, 8, 9, 12, 17, 21, 22, 23, 26], "100": [1, 2, 5, 8, 9, 21, 22, 23, 26], "1000": 6, "1000000": [1, 2, 5, 8, 9], "100gb": 6, "11": [3, 6, 12], "12": [0, 1, 2, 3, 5, 8, 9, 12, 17, 23], "13": [4, 19, 20, 21], "14": [1, 2, 5, 8, 9], "141592653589793": 0, "1440": [0, 4, 17, 23], "15": [1, 2, 5, 8, 9, 23], "17": 11, "18": 11, "180": [1, 2, 5, 8, 9, 12, 16, 24, 26], "1850": 17, "1940": [12, 20], "1950": 23, "1969": [16, 22], "1980": 16, "2": [0, 1, 2, 4, 5, 6, 8, 9, 10, 11, 18, 19, 21, 22, 23, 26], "20": [0, 1, 2, 5, 8, 9, 21, 22], "200": 23, "2001": 14, "2011": 10, "2020": 12, "2022": [20, 23], "2023": 12, "2024": 16, "2050": 17, "21": [1, 2, 5, 8, 9], "23": 0, "25": [1, 2, 5, 8, 9, 22, 23, 24, 26], "250": [], "273": 17, "2m": 16, "2m_temperatur": [6, 12, 13, 20, 22], "3": [0, 1, 2, 4, 5, 7, 8, 9, 11, 12, 17, 20, 21, 22, 23, 26], "300": [1, 2, 5, 8, 9], "3000": 4, "303": 22, "31": 21, "32": 6, "345": 21, "360": 16, "3f": 0, "4": [0, 1, 2, 4, 5, 6, 8, 9, 11, 17, 19, 23, 26], "40": 0, "435": 22, "455": 22, "5": [0, 1, 2, 4, 5, 6, 8, 9, 17, 18, 19, 21, 22, 23, 26], "50": [1, 2, 5, 8, 9, 26], "500": [1, 2, 6, 8, 9], "515": 22, "535": 22, "5e": 6, "6": [11, 23], "60": [1, 2, 5, 8, 9], "607": 22, "61": 0, "68": 21, "683": 22, "7": [1, 2, 4, 5, 8, 9, 11, 17, 19, 23], "721": [0, 4, 17, 23], "721x1440": 3, "75": [1, 2, 5, 8, 9], "8": [1, 2, 5, 8, 9, 11, 21], "85": 21, "8gb": 13, "9": [0, 11, 17, 19, 26], "90": [1, 2, 5, 8, 9, 12, 24, 26], "95": 22, "99999": 19, "A": [11, 18], "And": [0, 3, 12, 15, 16], "As": 6, "But": [15, 16], "By": [1, 2, 8, 9, 11], "For": [6, 7, 9, 11, 18, 21], "If": [0, 2, 6, 11, 16, 22], "In": 10, "It": [3, 7, 13, 16, 23], "No": [1, 2, 5, 8, 9, 12], "Of": 16, "That": [15, 16], "The": [1, 2, 3, 8, 9, 10, 11, 13, 16, 17, 18, 19, 20, 21, 22, 23], "Then": [3, 6, 7, 11], "There": [24, 26], "These": [19, 20], "To": [3, 6, 7, 9, 11, 15, 16, 17, 18, 19, 20, 21], "Will": 13, "_": [], "__file__": [19, 20], "__init__": 0, "ab": [1, 2, 5, 8, 9], "abil": [], "abl": 3, "about": [1, 2, 5, 8, 9, 13, 16, 17, 20, 23, 26], "abov": [1, 2, 15, 16], "access": [3, 13, 24], "account": 15, "accumul": 7, "accur": 16, "accuraci": 16, "acknowledg": 16, "action": [1, 2, 8, 9], "activ": [0, 11, 15], "actual": 22, "adam": [1, 2, 6], "adapt": 16, "add": [12, 17], "add_argu": [1, 2, 5, 7, 8, 9, 12, 17, 19, 20, 21, 22, 23], "add_ax": [21, 22, 23], "add_coord_system": 12, "add_lin": [1, 2, 5, 8, 9, 23, 26], "add_n": 0, "add_patch": [21, 22, 23, 26], "addit": 16, "addlin": [1, 2, 5, 8, 9], "addon": 11, "adequ": 16, "adjust": 26, "advantag": 3, "afil": 4, "africa": 10, "after": 18, "again": [13, 17], "against": 0, "aggument": [], "agre": 10, "ai": 10, "aim": [16, 19], "air": 16, "all": [5, 6, 7, 9, 10, 11, 12, 13, 16, 17, 18, 19, 20, 24, 26], "all_stat": [1, 2, 5, 8, 9], "allow": 16, "almost": 19, "alpha": [1, 2, 5, 8, 9, 26], "alreadi": [3, 13, 16], "also": [1, 2, 8, 9, 13, 17, 20, 23], "altern": 16, "alwai": 4, "amonth": 4, "an": [1, 2, 3, 5, 6, 8, 9, 10, 11, 14, 16, 23, 24, 26], "anaconda": 11, "analysi": [12, 19, 20, 24, 26], "anchor": 26, "ani": [0, 1, 2, 7, 10, 16], "anoth": [19, 20], "answer": 16, "anyth": [1, 2, 16], "anywai": 16, "api": [11, 13], "appear": 10, "append": [1, 4, 8, 19, 23], "applic": 16, "apply_gradi": 0, "approach": 16, "appropri": [], "approxim": [16, 22], "ar": [0, 2, 3, 4, 5, 7, 10, 11, 13, 14, 15, 16, 17, 21, 23, 24, 26], "arang": [24, 26], "araw": 23, "arbitrari": [6, 14], "area": 0, "arg": [0, 1, 2, 5, 7, 8, 9, 12, 17, 19, 20, 21, 22, 23], "argpars": [1, 2, 5, 7, 8, 9, 12, 17, 19, 20, 21, 22, 23], "args_dict": [1, 2], "argument": [1, 2, 8, 9, 17, 19, 20, 21, 22, 23, 26], "argumentpars": [1, 2, 5, 7, 8, 9, 12, 17, 19, 20, 21, 22, 23], "arial": [1, 2, 5, 8, 9, 21, 22, 23], "aris": 16, "around": 18, "arrai": [1, 2, 5, 8, 9], "artifici": 17, "as_default": [0, 7], "assembl": [16, 18], "assert_existing_objects_match": 0, "assign": [0, 11], "assign_add": 0, "assimil": [3, 15, 16], "assimilate_multi": 1, "assist": 10, "assum": 26, "attent": 18, "attribut": 16, "author": 16, "auto": [1, 2, 5, 8, 9], "autoencod": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 16], "autoencodermodel": [1, 2, 7, 8, 9], "autotun": [4, 17], "avail": [4, 6, 11], "averag": [4, 7, 12, 13], "awesom": 13, "ax": [1, 2, 5, 8, 9, 21, 23, 26], "ax_hist_norm": 22, "ax_hist_raw": 22, "ax_kld": [1, 2, 5, 8, 9], "ax_loc": 21, "ax_location_cb": 21, "ax_loss": [1, 2, 5, 8, 9], "ax_map": 26, "ax_norm": 22, "ax_raw": 22, "ax_rms": [1, 2, 5, 8, 9], "ax_sampl": 23, "ax_scal": 21, "ax_scale_cb": 21, "ax_shap": 21, "ax_shape_cb": 21, "ax_var": [1, 2, 5, 8, 9], "axb": [21, 22, 23], "axi": [0, 1, 2, 5, 8, 9], "aymax": [1, 2, 5, 8, 9], "b": [1, 2, 5, 8, 9], "back": [6, 16], "backend": [1, 2, 5, 8, 9, 21, 22, 23], "backend_agg": [1, 2, 5, 8, 9, 21, 22, 23], "background": [], "bad": [4, 19], "balanc": [1, 2, 5, 8, 9, 21, 22, 26], "base": [1, 2, 5, 8, 9, 19, 22], "bash": [13, 17, 20], "basic": 11, "batch": [0, 1, 2, 3, 7, 8, 9, 17, 19, 23], "batch_loss": 0, "batchsiz": [0, 6, 7], "bbox": [1, 2, 5, 8, 9], "becaus": 3, "becom": [1, 2, 5, 8, 9], "been": [3, 11, 16], "befor": [13, 16, 24], "behav": 16, "bei": 10, "below": 16, "benefit": 10, "beta": [0, 3, 6, 15], "better": 16, "between": [16, 19, 20], "bias": 16, "big": 3, "bilinear": 11, "bin": [1, 2, 5, 7, 8, 9, 12, 13, 14, 17, 19, 20, 21, 22, 23, 26], "birmingham": 16, "black": [1, 8, 11, 16, 26], "blame": 10, "blue": [5, 26], "blur": [17, 19], "boolean_mask": [1, 2], "both": [1, 2, 3, 5, 8, 9, 10, 16, 19], "bother": 14, "bottom": [1, 2, 5, 8, 9, 17, 18, 21, 22], "box": 26, "boxstyl": [1, 2, 5, 8, 9], "break": [1, 2, 4, 5, 8, 9], "brohan": 10, "bsd": 16, "buffer": 6, "build": [3, 11, 16, 24], "built": 16, "c": [12, 14, 24, 26], "cach": [4, 17, 19, 23], "calcul": [0, 1, 2, 5, 8, 9, 10, 15, 16, 18, 19], "calcult": 0, "calendar": 17, "call": [0, 8, 9, 19, 20], "callabl": 26, "came": 10, "can": [0, 2, 3, 4, 6, 7, 8, 9, 11, 13, 15, 16, 17, 19, 20], "canva": [1, 2, 5, 8, 9, 21, 22, 23], "care": [16, 26], "case": [1, 2, 5, 6, 8, 9, 16, 17], "caus": 19, "cb": 21, "cbe": 12, "cd": [11, 13, 17, 20], "cdf": [18, 19], "cdsapi": [11, 12, 14], "cell": [1, 2, 5, 8, 9, 12, 14, 23], "centr": [1, 2, 5, 8, 9, 10, 16, 17, 21], "cepoch": 5, "chang": [3, 10, 15, 16], "channel": 11, "chatgpt": 10, "cheaper": 16, "check_numer": 19, "choic": 23, "choos": [1, 2, 5, 7, 8, 9, 16, 22], "chosen": 16, "cht": [1, 2, 5, 8, 9], "ckpt": [0, 7], "class": [0, 3], "clear": 16, "clearli": 16, "client": [12, 14], "climat": [0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 13, 17, 19, 20, 21], "climatologi": [0, 16], "clip": 0, "clip_by_norm": 0, "clone": 15, "close": 16, "cluster": [17, 20], "cm": [1, 2, 5, 8, 9, 21, 22, 26], "cmap": [1, 2, 5, 8, 9, 21, 22, 26], "cmd": 20, "cmocean": [1, 2, 5, 8, 9, 11, 21, 22, 26], "cnn": [], "co2": 16, "code": [3, 10, 11, 15, 16], "col": [1, 2, 5, 8, 9], "collect": 16, "color": [1, 2, 5, 8, 9, 23, 26], "colorbar": 21, "colour": 22, "colourmap": [1, 2, 5, 8, 9, 26], "column": [2, 9, 16], "com": [], "combin": [6, 18], "command": [17, 20], "common": [16, 20, 24], "comp_font_s": [1, 2, 5, 8, 9], "compar": [0, 5, 16, 22], "comparison": [5, 9, 16], "complex": 16, "compon": [0, 1, 2, 5, 8, 9], "compress": [22, 26], "comput": 11, "compute_loss": 0, "computescalarstat": [1, 2, 5, 8, 9], "concat": 4, "conda": [10, 11, 13], "config": [19, 20], "configur": [0, 4, 7, 10], "confus": [1, 2, 8, 9, 17, 20, 23], "consist": [8, 19, 20], "constant": [1, 2, 4, 17], "constrain": 16, "constraint": [1, 2, 5, 8, 9, 12], "contain": 17, "content": [4, 17], "continu": [1, 2, 4, 5, 7, 8, 9, 19, 20], "control": [6, 7, 16], "conv2d": 0, "conv2dtranspos": 0, "conveni": [1, 2, 5, 8, 9, 16, 26], "convert": [0, 3, 16, 17, 18, 19, 20], "convert_to_tensor": [19, 20], "convolut": [0, 3, 7], "coodin": 12, "coord": [12, 24, 26], "coord_system": [12, 24, 26], "coord_valu": [1, 2, 5, 8, 9], "coordin": 26, "coordinatenotfounderror": 26, "copernicu": [10, 11, 13], "copi": [1, 2, 3, 5, 6, 7, 8, 9, 15, 17, 19, 20], "copilot": 10, "copyright": 16, "core": [1, 2, 5, 8, 9, 19, 20], "correct": 16, "correlatedensembl": [4, 6], "correspond": 16, "could": 16, "count": [17, 20], "cours": 16, "creat": [4, 6, 11, 16, 17, 19, 20], "create_file_writ": 7, "creativ": 15, "credit": 10, "critic": 10, "crop_by_perc": 26, "crown": 16, "crucial": 16, "cs_era5": 12, "ctrlb": [12, 14], "cube": [12, 19, 20, 23, 24, 26], "cuda": [1, 2, 8, 9, 17, 20, 23], "cumul": 18, "current": [0, 7, 10], "curv": 23, "cut": [7, 24], "cv": 0, "cymax": 5, "cymin": 5, "d": [1, 2, 4, 5, 8, 9, 12, 16], "dai": [1, 2, 5, 8, 9], "darker": [5, 16], "dask": [19, 20], "data": [0, 1, 3, 5, 6, 7, 8, 10, 11, 15, 24, 26], "dataset": [1, 2, 3, 6, 7, 8, 9, 16, 17, 19, 20], "date": [1, 2, 4, 5, 8, 9, 14, 17], "datestr": [1, 2, 5, 8, 9], "datetim": [1, 2, 5, 8, 9], "datum": 26, "datum_support": [12, 26], "dcvae": [0, 1, 2, 3, 5, 7, 8, 9, 11, 16, 17, 19, 20, 21], "dcvae_clim": 11, "debug": [0, 19], "decod": [3, 16], "decodefit": [1, 2], "deep": [0, 3], "def": [0, 1, 2, 4, 5, 7, 8, 9, 12, 17, 19, 20, 23, 26], "default": [6, 12, 17, 19, 20, 21, 22, 23], "default_rng": 23, "defin": [0, 14, 25], "degre": [16, 24, 26], "degrees_east": [24, 26], "degrees_north": [24, 26], "dejavu": [1, 2, 5, 8, 9], "demonstr": 16, "dens": [], "densiti": 26, "depend": [0, 11, 13], "design": 6, "desir": [2, 9, 16], "dest": [1, 8], "detail": [16, 17], "deviat": [18, 22], "diagnost": [11, 16], "dict": [1, 2, 5, 8, 9], "diff": [1, 2, 5, 8, 9, 22], "differ": [0, 15, 16, 18], "difficult": 16, "dim_coords_and_dim": [24, 26], "dimcoord": [24, 26], "dimens": [0, 12], "dimension": 3, "dir": 4, "direct": 10, "directori": [3, 6, 7, 11, 12, 13, 17, 18], "dirnam": [7, 19, 20], "disabl": [5, 8, 9], "disc": [11, 13], "discuss": [], "distinct": 16, "distribut": [0, 3, 6, 7, 9, 10, 16, 17, 18, 19, 21, 22], "diverg": [1, 2, 5, 6, 8, 9, 16], "divers": 16, "do": [0, 6, 11, 13, 15, 16, 17, 18, 19, 20, 23, 24], "doc": [], "document": [3, 10, 11, 16], "doe": [2, 10, 12, 16, 21, 23], "don": [1, 2, 5, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 20, 23, 26], "done": [3, 13, 15, 18], "down": [7, 16], "download": [10, 13, 15, 16, 18, 19, 20], "download_all_data": 13, "dpi": [1, 2, 5, 8, 9, 21, 22, 23], "dramat": 16, "driven": 16, "dta": [1, 2, 5, 8, 9], "dta2": [1, 2, 5, 8, 9], "dtp": [1, 2, 5, 8, 9], "dtype": [1, 2, 17], "dummi": 26, "dummy_data": [24, 26], "dure": 17, "e": [3, 4], "e5sc": 24, "e5scub": [1, 2, 5, 8, 9, 17, 19, 20, 22, 24], "each": [0, 1, 2, 4, 5, 7, 8, 9, 16, 17, 18, 20, 23], "earli": 24, "earlier": 11, "easi": 14, "easier": [11, 15, 24], "easiest": 11, "edgecolor": [1, 2, 5, 8, 9, 21, 22, 23], "edit": [3, 7, 11], "edu": [], "effect": [2, 16], "effici": [16, 17, 19, 20], "eigen": 11, "elif": [1, 2, 4, 5, 8, 9], "els": [0, 1, 2, 4, 5, 6, 8, 9, 16, 22, 26], "elu": 0, "email": 10, "embed": [3, 16], "emerg": 16, "en": [], "encod": [0, 1, 2, 3, 5, 8, 9], "end": [6, 17, 23], "end_monitoring_tim": 7, "end_training_tim": 7, "endors": 10, "endyear": [1, 4, 6, 8, 12, 17, 23], "enough": [4, 16, 17], "ensembl": [4, 6], "entir": [], "entireti": 10, "env": [1, 2, 5, 7, 8, 9, 12, 14, 17, 19, 20, 21, 22, 23], "environ": [1, 2, 7, 8, 9, 10, 13, 15, 17, 20, 23], "ep": [0, 10], "epoch": [0, 1, 2, 5, 6, 7, 8, 9, 23], "epoch_": [0, 7], "epsrc": 10, "equal": 26, "equat": 16, "equirectangular": 26, "equival": [18, 22], "era5": [3, 4, 6, 10, 11, 13, 14, 16, 24, 26], "era5_monthli": [19, 20, 22], "error": [0, 12], "essenti": 18, "establish": 16, "estim": [16, 18, 21], "etc": 3, "eu": 11, "evalu": 15, "even": [10, 16], "event": [1, 2, 5, 8, 9], "event_pb2": [1, 2, 5, 8, 9], "everi": [6, 7, 11, 12, 17], "everyth": [1, 2, 5, 6, 8, 9, 24], "exactli": [3, 16], "exampl": [0, 3, 16], "except": [1, 2, 4, 5, 8, 9, 12, 24, 26], "exist": [10, 19, 20], "exist_ok": [12, 14, 17], "exit": [], "exp": 0, "expand": 17, "expect": 16, "expect_parti": 0, "expens": 16, "experi": 3, "experiment": [4, 17], "experimental_distribute_dataset": 7, "explicit": 12, "expver": 12, "extend": [1, 2, 5, 8, 9, 16], "extens": 10, "extent": [15, 16], "extern": [19, 20], "extract": [1, 2, 5, 8, 9, 12, 23, 26], "extract_pol": 26, "f_alpha": 26, "facecolor": [1, 2, 5, 8, 9, 21, 22, 23, 26], "factor": [6, 16], "factori": [3, 16], "fail": 13, "failur": 19, "fals": [0, 1, 2, 4, 5, 6, 7, 8, 9, 12, 17, 19, 20, 21, 22, 23, 24], "famili": [1, 2, 5, 8, 9, 21, 22, 23], "familiar": [], "far": [6, 11], "fast": 3, "faster": [6, 11], "fc": [1, 2, 5, 8, 9], "featur": 15, "few": [11, 13], "fg_locat": 17, "fg_scale": 17, "fg_shape": 17, "field": [0, 1, 2, 3, 5, 6, 7, 8, 9, 16, 26], "field_idx": [1, 2], "field_to_scalar": [1, 2, 5, 8, 9], "fig": [1, 2, 5, 8, 9, 21, 22, 23], "figscal": [1, 2, 5, 8, 9], "figsiz": [1, 2, 5, 8, 9, 21, 22, 23], "figur": [1, 2, 5, 8, 9, 21, 22, 23], "figurecanva": [1, 2, 5, 8, 9, 21, 22, 23], "figurecanvasagg": [1, 2, 5, 8, 9, 21, 22, 23], "file": [0, 3, 4, 7, 11, 12, 14, 15, 16, 17, 18, 19, 20, 24, 26], "file_nam": [4, 17], "filenam": [1, 2, 4, 5, 8, 9, 17], "filesym": 4, "fill": [21, 22, 23, 26], "filter": 0, "find": [2, 4, 16, 17, 18, 19], "fine": 14, "first": [1, 2, 5, 8, 9, 11, 16, 18], "firstyr": 4, "fit": [0, 1, 2, 6, 17, 18, 19, 21, 22, 23], "fit_for_month": [], "fit_loss": 0, "fit_metr": 0, "fix": [3, 19], "flatten": [1, 2, 5, 8, 9, 26], "float": [5, 8], "float32": [0, 1, 2, 4, 17, 19, 20], "flow": [], "fn": [4, 17, 19, 20], "fname": [4, 12], "fnfile": 17, "fni": 4, "focu": 16, "focus": 18, "follow": [0, 4, 6, 15], "font": [1, 2, 5, 8, 9, 21, 22, 23], "font_manag": [5, 8, 9], "fontsiz": [1, 2, 5, 8, 9], "forc": 16, "forg": 11, "fork": 15, "format": [0, 7, 12, 14, 16, 18, 19, 20], "formatt": 11, "found": [1, 2, 5, 8, 9], "four": 13, "fourth": [1, 2, 5, 8, 9], "fraction": [0, 1, 2, 5, 8, 9, 21], "frameon": [1, 2, 5, 8, 9, 21, 22, 23], "framework": [1, 2, 5, 8, 9], "free": [11, 15], "from": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 26], "from_tensor_slic": [4, 17], "fromstr": [1, 2, 5, 8, 9], "ftt": 12, "full": 0, "function": [0, 1, 2, 3, 5, 8, 9, 12, 15, 16, 17, 18, 19, 20, 26], "fund": 10, "fundament": 16, "futur": [12, 16, 26], "g": 0, "gamma": [0, 6, 17, 18, 19, 22], "gamma_p": 19, "gcm": 16, "gener": [0, 1, 2, 3, 4, 5, 7, 8, 9, 11], "generative_artificial_intellig": [], "geograph": 24, "get": [1, 2, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 17, 23, 26], "get_cmap": [1, 2, 5, 8, 9], "get_data": [13, 19, 20, 22], "get_data_for_period_era5": 13, "get_land_mask": 26, "get_land_mask_from_era5_land": 13, "get_strategi": 9, "get_year_of_monthlies_from_era5": 12, "getdataavail": 4, "getdataset": [1, 2, 4, 7, 8, 9, 17, 19, 23], "getenv": [0, 1, 2, 4, 5, 7, 8, 9, 12, 14, 17, 19, 20, 21, 26], "getfilenam": [4, 17], "getlogg": [5, 8, 9], "getmodel": [0, 1, 2, 7, 8, 9], "getmtim": [1, 2, 5, 8, 9], "gigabyt": 11, "git": 10, "github": [10, 15], "give": 18, "given": [2, 16, 17, 26], "global": [1, 8, 16], "gmutil": [1, 2, 5, 8, 9], "gnu": [10, 17, 20], "go": [1, 2, 8, 9, 10, 13, 15, 16, 17, 19, 20], "good": [2, 16, 23], "gov": 10, "govern": 16, "gpu": [1, 2, 7, 8, 9, 11, 17, 20, 23], "gpu_py39hd4ae112_0": 11, "gradient": 0, "gradienttap": 0, "graphic": 23, "great": [4, 16, 17], "grid": [1, 2, 3, 5, 8, 9, 12, 14, 16, 17, 18, 19, 20, 22, 23, 26], "grid_cub": 26, "grid_latitud": [1, 2, 5, 8, 9, 24, 26], "grid_longitud": [1, 2, 5, 8, 9, 24, 26], "grid_mapping_nam": 26, "grid_north_pole_latitud": 26, "grid_north_pole_longitud": 26, "gridsiz": 26, "guess": 0, "gv": 0, "gw4": 10, "h03": 11, "ha": [1, 2, 3, 5, 8, 9, 16, 18], "hack": 11, "hadlei": 10, "hadpb": 11, "half": 16, "hand": [2, 9, 16], "happen": 19, "hard": 16, "have": [2, 3, 4, 11, 12, 14, 15, 16, 17, 18, 19, 20, 23], "he": 10, "height": [12, 23], "help": [0, 1, 2, 5, 7, 8, 9, 10, 12, 17, 19, 20, 21, 22, 23], "here": [6, 10, 16], "hexbin": 26, "high": [14, 26], "him": 10, "hist": 26, "histogram": [22, 23, 26], "histori": [1, 2, 3, 8, 9], "home": 11, "host": [], "hour": 13, "how": [4, 6, 11, 16], "hpc": 10, "ht": [1, 2, 5, 8, 9], "http": [3, 11], "hundr": 11, "hyperparamet": [0, 3, 6, 15, 16], "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 24, 26], "ic": 17, "ice_r": 26, "ict": [19, 20], "ident": 24, "idx": [1, 2, 5, 8, 9], "iff": [4, 17], "illustr": 16, "ima": 4, "import": [0, 1, 2, 4, 5, 6, 7, 8, 9, 12, 14, 16, 17, 19, 20, 21, 22, 23, 24, 26], "improv": 16, "imt": [4, 17], "includ": [16, 17], "increas": 16, "index": [1, 2], "individu": 16, "infer": [2, 16], "infil": [4, 17], "inform": [], "initi": 0, "initialis": 0, "input": [0, 1, 2, 3, 5, 6, 7, 8, 9, 11, 16, 22], "input_shap": 0, "inputlay": 0, "inputtensor": [4, 6], "instabl": 6, "instal": [11, 13], "instanc": 0, "instanti": [0, 6, 7], "instead": [1, 2, 8, 9, 10, 18, 24], "instruct": [0, 4, 6], "int": [1, 2, 4, 5, 7, 8, 9, 12, 17, 19, 20, 21, 22, 23], "integ": [19, 20], "interest": 16, "interpol": 11, "invers": 18, "investig": 16, "involv": [], "io": [4, 17, 19, 20], "iri": [1, 2, 5, 8, 9, 11, 12, 17, 19, 20, 21, 23, 24, 26], "is_don": [19, 20], "is_mask": 26, "is_nan": 17, "isambard": [9, 10], "isdir": [7, 12, 14, 17, 19, 20], "isfil": [12, 14], "isinst": [1, 2, 5, 8, 9], "isnan": [17, 20], "issu": [10, 16], "item": [1, 2, 5, 8, 9], "iter": [1, 2, 5, 8, 9], "its": [1, 2, 3, 5, 8, 9, 10, 16, 18], "itself": 16, "j": 13, "januari": 17, "job": [11, 17, 20], "join": [1, 2, 5, 8, 9], "just": [2, 13, 14, 15, 16], "keep": [0, 6, 15], "kei": [1, 2, 4, 5, 8, 9, 16], "kelvin": 16, "kept": [], "kera": [0, 1, 2, 3, 6], "kernel_s": 0, "kl": [1, 2, 5, 6, 8, 9], "kld": 0, "know": [10, 16, 17], "label": [1, 2, 5, 8, 9], "labels": [1, 2, 5, 8, 9], "lambda": [1, 2, 5, 8, 9, 12, 17], "land": [13, 26], "land_mask": [12, 13, 14, 26], "larg": 6, "last": [0, 1, 8], "lastyr": 4, "lat": 26, "lat_valu": [24, 26], "latent": [0, 1, 2, 6], "later": 11, "latitud": [8, 12, 24, 26], "layer": [0, 3, 15], "layout": [1, 2, 5, 8, 9], "learn": 3, "learning_r": [1, 2], "least": 16, "left": [1, 2, 5, 8, 9, 16], "len": [1, 2, 4, 5, 6, 8, 9, 12, 24, 26], "length": 6, "less": [6, 16], "let": 16, "level": [12, 16], "librari": [10, 19, 20, 25], "libwebp": 11, "licenc": 16, "lighter": 5, "like": [2, 9, 16, 23], "limit": 4, "line": [1, 2, 5, 8, 9, 16, 23, 26], "line2d": [1, 2, 5, 8, 9, 23, 26], "linear": 26, "linestyl": [1, 2, 5, 8, 9, 26], "linewidth": [1, 2, 5, 8, 9, 21, 22, 23, 26], "linspac": 23, "linux": 11, "list": [1, 2, 4, 5, 8, 9, 10, 17, 20], "listdir": [1, 2, 4, 5, 8, 9, 17], "listedcolormap": 26, "listifi": [1, 2, 5, 8, 9], "ll": 11, "lm": 26, "lmask": 26, "load": [0, 1, 2, 4, 5, 7, 8, 9, 12, 13, 17, 19, 20, 21, 22, 23], "load_cub": [12, 19, 21, 26], "load_fit": [19, 22, 23], "load_raw": [19, 20], "load_statu": 0, "load_tensor": [4, 17], "load_weight": 0, "loadhistori": [1, 2, 5, 8, 9], "loc": [19, 23], "local": 15, "locat": [17, 18, 19, 21, 22, 23, 26], "location_img": 21, "location_m": [17, 19, 21], "log": [0, 1, 2, 5, 7, 8, 9, 26], "log2pi": 0, "log_fn": 7, "log_normal_pdf": 0, "logfil": 7, "logfile_writ": [0, 7], "logical_and": [17, 19], "logpz": [0, 1, 2, 5, 8, 9], "logpz_g": 0, "logqz_g": 0, "logqz_x": [0, 1, 2, 5, 8, 9], "logvar": 0, "lon": 26, "lon_valu": [24, 26], "london": 16, "long_nam": 12, "longitud": [8, 12, 16, 24, 26], "look": [2, 9, 11, 16], "loss": [0, 1, 2, 5, 7, 8, 9, 15, 16], "loss_valu": 0, "lot": [3, 6, 11], "low": 3, "lsc": [1, 2, 5, 8, 9], "m": [1, 2, 5, 8, 9], "m_fit": 23, "m_valu": 23, "ma": [1, 2, 5, 8, 9, 17, 19, 20, 24, 26], "machin": 15, "made": 17, "mai": 16, "main": [1, 2, 5, 8, 9, 16, 17, 20], "maintain": 10, "major": 16, "make": [0, 2, 3, 5, 7, 8, 9, 10, 11, 15, 16, 17, 18, 19, 20, 21, 22, 23, 26], "make_all_fit": 17, "make_all_raw_tensor": 20, "make_all_tensor": 20, "make_ax": 23, "make_dataset": [], "make_raw": 18, "make_training_tensor": 20, "makedataset": [1, 2, 7, 8, 9, 17, 19, 23], "makedir": [7, 12, 14, 17, 19, 20], "makelat": [0, 1, 2], "makendarrai": [1, 2, 5, 8, 9], "manag": 11, "mani": [4, 6, 16], "manipul": [19, 20], "map": [1, 2, 4, 5, 8, 9, 16, 17, 21, 22, 26], "march": [16, 22, 23], "mask": [0, 1, 2, 5, 6, 8, 9, 12, 13, 17, 19, 20, 26], "mask_img": 26, "masked_wher": [1, 2, 5, 8, 9], "maskedarrai": [17, 19, 20, 24], "match": [6, 16, 19], "match_norm": 19, "match_origin": 19, "math": [0, 1, 2, 17], "matplotlib": [1, 2, 5, 8, 9, 21, 22, 23, 26], "matter": 16, "max": [1, 2, 5, 8, 9, 23, 26], "max_epoch": [1, 2, 5, 8, 9], "max_lat": [1, 2, 5, 8, 9], "max_lon": [1, 2, 5, 8, 9], "maxcount": 4, "maxensemblecombin": [4, 6], "maxgradi": [0, 6], "maximis": 2, "maximum": [4, 5, 8], "maxtestmonth": [4, 6], "maxtrainingmonth": [4, 6], "mayb": 15, "mbatch": [0, 7], "mean": [0, 1, 2, 3, 5, 8, 9, 10, 12, 14, 16, 17, 18, 19, 22, 23], "mean_sea_level_pressur": [6, 12, 13, 20, 21, 22], "mean_squared_error": [1, 2], "member": [4, 6, 20], "messag": [1, 2, 5, 7, 8, 9, 12, 17, 20, 23], "met": 10, "method": 16, "metoffic": 10, "metric": [0, 1, 2, 6, 7], "mflat": [1, 2, 5, 8, 9], "mid": 24, "middl": [2, 9, 16], "might": 11, "min": [1, 2, 4, 5, 8, 9, 17, 26], "min_lat": [1, 2, 5, 8, 9], "min_lon": [1, 2, 5, 8, 9], "mincnt": 26, "miniconda": 11, "minim": [1, 2], "minimis": 2, "minimum": [5, 8], "mirroredstrategi": 6, "miss": [0, 5, 8, 9, 19], "ml": [3, 6, 11, 16, 18, 19, 20], "ml_default": [], "ml_model": [1, 2, 5, 7, 8, 9], "mle": [], "mm": 16, "mnth": 4, "mo": 11, "moan": [1, 2, 8, 9, 17, 20, 23], "mode": 2, "model": [4, 11, 15, 18, 19, 20, 24], "modelnam": [0, 5, 6, 7], "modif": [], "modifi": 6, "modul": 11, "moment": 17, "monitor": [0, 11], "month": [3, 4, 5, 6, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23], "monthli": [3, 4, 12, 13, 14, 16, 19, 20, 22, 26], "monthly_averaged_reanalysi": [12, 14], "more": [6, 10, 15, 16], "most": [11, 18, 19], "mostli": 16, "move": [16, 24], "mslp": [1, 2, 5, 6, 8, 9, 16], "much": [11, 15, 16, 23, 24], "multi": [1, 2, 5, 8, 9], "multipl": 4, "must": 12, "n": [0, 1, 2, 5, 6, 8, 9], "n_epoch": [1, 2, 5, 8, 9], "name": [1, 2, 4, 5, 8, 9, 10, 11, 12, 17, 19, 20, 21, 22], "nan": [17, 20], "nation": 10, "nc": [12, 14, 17, 19, 21, 26], "ncol": [1, 2, 5, 8, 9], "nearest": 12, "necessari": [11, 15, 16, 19, 20], "need": [1, 2, 3, 4, 5, 6, 8, 9, 11, 13, 16, 17, 18, 20, 23], "nepoch": [6, 7], "net": 3, "netcdf": [12, 14, 16, 18, 19, 20], "network": [], "neural": 3, "never": 19, "new": [2, 3, 6, 7, 16], "newton": 10, "next": 18, "nfield": [1, 2, 5, 8, 9], "ninputchannel": [0, 6], "nmonthsinepoch": 6, "nois": 17, "none": [0, 1, 2, 4, 5, 6, 7, 8, 9, 12, 17, 19, 20, 21, 22, 23, 26], "nonetheless": 16, "norm": 19, "norm_mean": 19, "norm_sd": 19, "normal": [0, 1, 2, 3, 5, 8, 9, 16, 20, 21, 23], "normalis": [3, 15, 19], "normalize_al": 17, "normalize_cub": [19, 22], "normalized_dataset": [4, 19], "north_pole_grid_longitud": 26, "notabl": 16, "note": [2, 10, 16], "noth": 23, "noutputchannel": [0, 1, 2, 5, 6, 8, 9], "now": [15, 16, 17, 18], "np": [1, 2, 4, 5, 8, 9, 12, 17, 19, 20, 21, 22, 23, 24, 26], "npg_longitud": [24, 26], "nrow": [1, 2, 5, 8, 9], "num": 23, "num_or_size_split": 0, "num_parallel_cal": [4, 17], "num_step": [1, 2], "numer": [0, 6, 19], "numpi": [0, 1, 2, 4, 5, 8, 9, 12, 17, 19, 20, 21, 22, 23, 24, 26], "nvar": [1, 2, 5, 8, 9], "o": [0, 1, 2, 4, 5, 7, 8, 9, 12, 14, 17, 19, 20, 21, 22, 23, 26], "object": [2, 4, 16, 17], "observ": 16, "obviou": 16, "offer": 16, "offic": 10, "offset": [1, 2, 5, 8, 9], "often": 6, "onc": [6, 16], "one": [0, 1, 2, 5, 6, 8, 9, 12, 13, 16, 17, 19, 20, 24], "onli": [0, 1, 2, 4, 5, 7, 8, 9, 11, 13, 14, 16], "opdir": [12, 14, 17, 19], "open": [11, 16], "oper": [10, 11], "opfil": [12, 19, 20], "optim": [0, 1, 2, 3, 6, 7], "optimis": [4, 17], "optimum": 17, "option": 11, "order": [4, 18], "org": 3, "organ": 10, "orient": 21, "origin": [1, 8, 16, 19, 22], "other": [15, 16, 17, 20], "our": [3, 16], "out": [0, 1, 2, 4, 5, 8, 9], "outfil": 4, "output": [0, 1, 2, 3, 5, 6, 7, 8, 9, 11, 12, 16, 17, 20], "output_pad": 0, "outputnam": [0, 1, 2, 5, 6, 7, 8, 9], "outputtensor": [1, 2, 4, 6], "over": [0, 7, 16, 24], "overal": [1, 2, 5, 8, 9], "overall_loss": 0, "overlai": 26, "own": [1, 2, 5, 8, 9, 15, 16], "p020224": 10, "pacif": 24, "packag": [3, 11], "pad": [0, 1, 2, 5, 8, 9], "page": [], "pair": 3, "pale": 16, "panda": 11, "panel": [], "parallel": [10, 11, 13, 17, 19, 20], "paramet": [6, 7, 18, 19], "parse_arg": [1, 2, 5, 7, 8, 9, 12, 17, 19, 20, 21, 22, 23], "parse_tensor": [4, 17], "parser": [1, 2, 5, 7, 8, 9, 12, 17, 19, 20, 21, 22, 23], "part": [10, 13], "particular": 16, "particularli": 3, "partnership": 10, "pascal": 16, "patch": [1, 2, 5, 8, 9, 21, 22, 23, 26], "path": [1, 2, 5, 7, 8, 9, 11, 12, 14, 17, 19, 20], "pattern": 16, "pcolorfast": 26, "pdf": [0, 16, 23], "peopl": [1, 2, 8, 9, 17, 20, 23], "per": [17, 20], "per_replica_loss": 0, "per_replica_op": 7, "percentil": 22, "perfect": 16, "perform": 16, "period": [6, 20], "person": 10, "philip": 10, "physic": 16, "pip": 11, "place": 12, "plain": [], "platform": 3, "plausibl": 16, "pleas": 10, "plenti": [7, 11], "plot": [1, 2, 3, 4, 8, 9, 13, 14, 16, 21, 22, 23], "plot_cub": 26, "plot_distribution_monthli": 22, "plot_gamma_fit": 21, "plot_sample_fit": 23, "plot_training_progress": 5, "plot_var": [1, 2, 5, 8, 9], "plotcub": 26, "plotfieldax": [1, 2, 5, 8, 9, 21, 22, 26], "plothistax": [22, 23, 26], "plotscalarstat": [1, 2, 5, 8, 9], "plotscatterax": [1, 2, 5, 8, 9, 26], "plottrainingmetr": [1, 2, 5, 8, 9], "plotvalidationfield": [1, 2, 5, 8, 9], "png": [1, 2, 5, 8, 9, 21, 22, 23], "point": [0, 1, 2, 12, 16, 17, 18, 23, 26], "pole": 26, "pole_latitud": [24, 26], "pole_longitud": [24, 26], "possibl": [6, 16], "power": 16, "ppf": 19, "prate": [1, 2, 5, 8, 9], "pre": [4, 17, 19], "precalcul": 19, "precip": [1, 2, 5, 6, 8, 9, 16], "precipit": [1, 3, 15, 16, 18, 22], "predict": 16, "prefer": [], "prefetch": [4, 17], "prepar": 17, "present": [3, 17], "pressur": [3, 15, 16], "pretti": 16, "previou": 5, "previous": [], "primarili": 16, "princip": 16, "print": [0, 6, 7, 12, 20, 26], "printinterv": [6, 7], "printout": 6, "printstat": [0, 7], "probabl": 11, "problem": [0, 16], "process": 17, "produc": [3, 16], "product": 16, "product_typ": [12, 14], "programm": 10, "progress": [5, 7, 16], "project": [11, 24, 26], "properli": 12, "properti": [16, 18], "protect": 6, "provid": [4, 6, 16, 18, 26], "publish": 16, "purpos": [1, 2, 3, 4, 7, 8, 9], "put": 10, "py": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 17, 20, 21, 22, 23], "python": [1, 2, 5, 7, 8, 9, 10, 11, 12, 14, 17, 19, 20, 21, 22, 23], "pythonpath": 11, "qd": [19, 20], "qualiti": 16, "quantil": 16, "question": 16, "quick": 23, "quit": 16, "rain": 22, "rais": [1, 2, 4, 5, 8, 9, 10, 12, 26], "ram": [4, 6, 17], "random": [0, 2, 4, 9, 16, 17, 23], "random_i": 23, "random_j": 23, "rang": [0, 1, 2, 4, 5, 7, 8, 9, 12, 16, 18, 19, 20, 23, 24, 26], "rate": [3, 15], "rather": 16, "raw": [16, 17, 18, 19, 22, 23], "raw_dataset": [17, 20], "raw_to_tensor": [19, 20], "raxi": 0, "rc": [1, 2, 5, 8, 9, 21, 22, 23], "re": [14, 18, 26], "read": [19, 20], "read_fil": [4, 17], "readi": [15, 18], "real": 16, "realiti": 16, "realli": [12, 14], "realpath": [19, 20], "reanalysi": [10, 12, 14, 16, 26], "reason": [16, 23], "reassembl": [19, 20], "recogn": 16, "recommend": [7, 15], "rectangl": [1, 2, 5, 8, 9, 21, 22, 23, 26], "red": [1, 5, 8, 16, 23], "reduc": 0, "reduce_mean": [0, 1, 2], "reduce_std": 0, "reduce_sum": 0, "reduceop": 0, "reduct": 0, "reformat": [19, 20], "region": [5, 8], "regist": [11, 13], "regrid": [12, 16, 20, 24, 26], "regular": [0, 1, 2, 5, 8, 9], "regularization_loss": [0, 1, 2, 5, 8, 9], "relat": 16, "relationship": 16, "reli": 11, "remain": 3, "rep": 4, "reparameter": 0, "repeat": [4, 7], "repeatedli": 3, "replac": [11, 23], "report": 7, "repositori": [11, 15], "repres": 16, "represent": 16, "reproduc": 16, "requir": [1, 2, 5, 7, 8, 9, 12, 17, 19, 20, 21, 22, 23], "reshap": [4, 17], "resolut": [14, 19, 20, 24, 26], "resourc": [7, 11], "respons": 10, "restart": [0, 7], "restructuredtext": [], "result": [1, 2, 4, 5, 7, 8, 9, 10, 15, 16, 19], "retrain": 15, "retriev": [12, 13, 14], "return": [0, 1, 2, 4, 5, 7, 8, 9, 12, 17, 19, 20, 23, 26], "rfile": [1, 2, 5, 8, 9], "rid": 12, "right": [1, 2, 5, 8, 9, 16, 18, 21], "rm": [1, 2, 5, 8, 9], "rmse": 0, "rng": 23, "root": 11, "rotated_latitude_longitud": 26, "rotatedgeogc": [12, 24, 26], "row": [1, 2, 5, 8, 9], "rscale": [1, 2, 5, 8, 9], "run": [0, 3, 5, 7, 8, 9, 11, 13, 15, 17, 18, 19, 20], "s_m": 23, "s_mask": [1, 2, 5, 8, 9], "sai": 16, "same": [0, 2, 3, 4, 6, 16, 18, 19], "sampl": [0, 4, 5, 16, 23], "sample_i": 23, "samples_": 23, "san": [1, 2, 5, 8, 9, 21, 22, 23], "save": [0, 6, 7, 17, 20], "save_dir": 7, "save_weight": 7, "savefig": [1, 2, 5, 8, 9, 21, 22, 23], "scalar": [0, 1, 2, 5, 8, 9], "scale": [5, 16, 17, 18, 19, 21, 22, 23], "scale_img": 21, "scale_m": [17, 19, 21], "scatter": [1, 2, 5, 8, 9, 16, 26], "scatterplot": [1, 8, 26], "schedul": [19, 20], "scienc": [10, 16], "scientist": 16, "scipi": [19, 22, 23], "scope": 7, "scratch": [0, 1, 2, 4, 5, 7, 8, 9, 11, 12, 14, 17, 19, 20, 21, 26], "script": [0, 1, 2, 3, 4, 5, 6, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23], "sd": 19, "sdir": [19, 20], "sea": [13, 16, 17], "sea_surface_temperatur": [12, 13, 17, 20], "search": [2, 11], "second": [1, 2, 5, 8, 9], "secondarili": 16, "secur": 11, "see": [11, 16, 23], "seen": 16, "select": [18, 19, 20, 22, 23], "self": 0, "selfc": 5, "send": 10, "sens": 16, "sensibl": 23, "sep": [1, 2, 5, 8, 9], "separ": [1, 2, 5, 8, 9, 17], "seper": 0, "sequenti": 0, "seri": [2, 3, 5, 9, 16], "serial": 16, "serialis": [19, 20], "serialize_tensor": [19, 20], "serialized_record": [1, 2, 5, 8, 9], "serif": [1, 2, 5, 8, 9, 21, 22, 23], "servic": 10, "set": [0, 1, 2, 3, 4, 7, 8, 9, 15, 16, 17, 26], "set_aspect": 26, "set_axis_off": [1, 2, 5, 8, 9, 21, 22, 23, 26], "set_inter_op_parallelism_thread": [19, 20], "set_titl": [1, 2, 5, 8, 9], "set_xlabel": [1, 2, 5, 8, 9], "set_xlim": [1, 2, 5, 8, 9, 26], "set_xtick": [1, 2, 5, 8, 9], "set_ylabel": [1, 2, 5, 8, 9], "set_ylim": [1, 2, 5, 8, 9, 26], "set_ytick": [1, 2, 5, 8, 9], "setup": [], "sever": [7, 12, 16], "sfig": [1, 2, 5, 8, 9], "sh": [13, 17, 20], "shape": [0, 12, 17, 19, 21, 22, 23], "shape_img": 21, "shape_m": [17, 19, 21], "share": 15, "sharei": [1, 2, 5, 8, 9], "sharex": [1, 2, 5, 8, 9], "should": [6, 9, 10, 11, 16, 18, 19, 22], "show": 23, "show_land": 26, "shuffl": [2, 6, 7, 9], "shufflebuffers": [2, 6, 7, 9], "sict": [4, 17, 19, 20], "similar": 16, "similarli": 18, "simpl": 9, "simplif": 16, "singl": [0, 1, 3, 5, 8, 12, 16, 19, 20], "size": [1, 2, 3, 4, 5, 6, 8, 9, 21, 22, 23], "skill": [0, 16], "smnth": 4, "so": [1, 2, 4, 12, 13, 14, 16, 17, 19, 20, 24], "softwar": [3, 10, 15, 16], "soil": 14, "soil_temperature_level_1": 14, "solid": 26, "some": [2, 11, 16, 17], "someth": [14, 16], "sort": [1, 2, 4, 5, 8, 9, 16, 17], "sourc": [4, 6, 7, 11, 16, 17], "south": 10, "space": [0, 2, 6, 11], "spatial": [16, 22], "spec": 6, "specif": [0, 1, 2, 3, 4, 5, 7, 8, 9, 16, 24], "specifi": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 16, 21], "sphinx": [10, 11], "spi": 19, "spite": 10, "split": [0, 1, 2, 4, 5, 8, 9], "sqrt": 17, "squar": [1, 2, 5, 8, 9], "squared_differ": [0, 17], "squeez": [1, 2, 5, 8, 9, 17, 19, 26], "srecord": [1, 2, 5, 8, 9], "sst": 17, "stage": 18, "stai": [1, 2, 5, 8, 9], "standard": [3, 16, 18, 20, 22, 25], "standard_nam": [24, 26], "standardis": [4, 19, 20], "start": [6, 17, 18, 23], "start_tim": 7, "startyear": [1, 4, 6, 8, 12, 17, 23], "stat": [1, 2, 5, 8, 9, 19, 22, 23], "state": [2, 3, 7, 16], "statist": [1, 2, 5, 8, 9, 16], "std": 23, "stddev": 17, "step": [0, 1, 2, 5, 7, 8, 9, 15, 18], "store": [10, 12, 13, 19, 20], "store_tru": [1, 2, 8, 9], "str": [1, 2, 5, 8, 9, 12, 17, 19, 20, 21, 22, 23], "strategi": [0, 6, 7, 9], "strictli": 16, "stride": 0, "string": [1, 2, 5, 8, 9], "strongli": [7, 15], "structur": [3, 16], "studi": 16, "subaxi": [1, 2, 5, 8, 9], "subclass": 3, "subfig": [1, 2, 5, 8, 9], "subfigur": [1, 2, 5, 8, 9], "submit": [17, 20], "subplot": [1, 2, 5, 8, 9], "subplotlayout": [1, 2, 5, 8, 9], "subplotpar": [1, 2, 5, 8, 9, 21, 22, 23], "subplots_adjust": [1, 2, 5, 8, 9], "subset": 6, "success": [3, 22], "successfulli": [], "sudden": 0, "suit": 3, "sum": [0, 1, 2, 5, 8, 9], "summari": [0, 1, 2, 5, 7, 8, 9], "summary_dir": [1, 2, 5, 8, 9], "super": 0, "suppli": 26, "support": 10, "supress": [1, 2, 8, 9, 17, 20, 23], "surfac": 13, "sy": [1, 2, 4, 5, 7, 8, 9, 17, 19, 20, 21, 22, 23], "system": [11, 12], "t": [1, 2, 4, 5, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 20, 23, 26], "t2m": [1, 2, 6, 16], "t_img": 26, "tag": [1, 2, 5, 8, 9], "take": [1, 2, 3, 4, 7, 8, 9, 13, 16, 17, 19, 20, 22, 23, 26], "taken": [0, 3, 17], "tang": 10, "tape": 0, "target": [0, 1, 2, 3, 5, 8, 9, 16, 24], "tarn": [1, 2, 5, 8, 9, 22], "task": 16, "tell": 11, "temperatur": [3, 14, 15, 16, 17, 21, 23], "tensor": [1, 2, 4, 5, 8, 9, 16, 17, 18], "tensor_to_cub": [1, 2, 5, 8, 9, 19, 20], "tensor_to_raw": 19, "tensor_util": [1, 2, 5, 8, 9, 19, 20], "tensorboard": [1, 2, 5, 8, 9], "tensorflow": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 17, 19, 20, 23], "tensorflow_prob": [1, 2], "term": 16, "test": [0, 3, 4, 5, 6, 7, 11, 16], "test_batch_count": 0, "test_logpz": [0, 1, 2, 5, 8, 9], "test_logpz_g": 0, "test_logqz_g": 0, "test_logqz_x": [0, 1, 2, 5, 8, 9], "test_loss": [0, 1, 2, 5, 8, 9], "test_n": 4, "test_rms": [0, 1, 2, 5, 8, 9], "test_rmse_m": 0, "test_rmse_mask": [0, 1, 2, 5, 8, 9], "testcach": [4, 6], "testd": 0, "testdata": [1, 7], "testsplit": [4, 6], "text": [1, 2, 5, 8, 9], "tf": [0, 1, 2, 3, 5, 6, 7, 8, 9, 16, 17, 23], "tf_cpp_min_log_level": [1, 2, 7, 8, 9, 17, 20, 23], "tfd": [19, 20], "tfp": [1, 2], "tfrecorddataset": [1, 2, 5, 8, 9], "than": [6, 16], "thei": [3, 11, 16, 23], "them": [3, 7, 15, 17, 18, 20], "thi": [0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 23, 24, 26], "thing": [15, 16], "think": 16, "third": [1, 2, 5, 8, 9], "those": [3, 16], "thread": [19, 20], "three": [1, 2, 5, 8, 9, 16, 21, 26], "through": [1, 2, 8, 9, 13, 15, 17, 19], "throughout": 10, "tick_param": [1, 2, 5, 8, 9], "tier": 10, "tight_layout": [1, 2, 5, 8, 9, 21, 22, 23], "time": [2, 3, 4, 5, 7, 9, 12, 14, 16, 21], "timedelta": [1, 2, 5, 8, 9], "tmux": 11, "tn_data": 17, "tnidata": 4, "tnodata": 4, "togeth": [4, 17], "tool": [3, 16, 26], "top": [1, 2, 5, 8, 9, 17, 18, 21, 22], "total_precipit": [6, 12, 13, 19, 20, 21, 22, 23], "track": 15, "tradit": 16, "train": [0, 3, 4, 6, 10, 15, 17, 19, 20, 23], "train_logpz": [0, 1, 2, 5, 8, 9], "train_logpz_g": 0, "train_logqz_g": 0, "train_logqz_x": [0, 1, 2, 5, 8, 9], "train_loss": [0, 1, 2, 5, 8, 9], "train_on_batch": [0, 7], "train_rms": [0, 1, 2, 5, 8, 9], "train_rmse_m": 0, "train_rmse_mask": [0, 1, 2, 5, 8, 9], "trainabl": [0, 2], "trainable_vari": [0, 1, 2], "traincach": [4, 6], "traind": 0, "training_histori": 3, "trainingdata": [7, 17, 19, 23], "trainingmask": [0, 1, 2, 5, 6, 7, 8, 9], "transfer": [], "transform": [16, 18], "trend": 16, "true": [0, 1, 2, 4, 5, 6, 8, 9, 12, 14, 17, 19, 20, 21, 22, 23, 26], "try": [1, 2, 5, 6, 8, 9, 15, 16, 26], "ts_data": 17, "tsidata": 4, "tsodata": 4, "tv": 0, "two": [0, 1, 2, 5, 8, 9, 18, 26], "type": [1, 2, 5, 7, 8, 9, 12, 17, 19, 20, 21, 22, 23], "typeerror": [1, 2, 5, 8, 9], "typic": 16, "tz_data": [4, 17], "u": [3, 16, 18], "ucar": [], "uk": [10, 16, 24], "unconstrain": 16, "under": [7, 16, 17], "understand": [12, 16], "unidata": [], "unit": [3, 16, 24, 26], "unmask": 0, "unnecessari": 12, "unnormalize_cub": 19, "unsupport": [4, 26], "up": [0, 1, 7, 8, 15], "updat": [0, 7], "update_metr": [0, 7], "updatelogfil": [0, 7], "upon": 3, "us": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 17, 18, 19, 20, 21, 22, 23, 24], "usefulli": 16, "user": [24, 26], "usr": [1, 2, 5, 7, 8, 9, 12, 13, 14, 17, 19, 20, 21, 22, 23], "utf": [1, 2, 5, 8, 9], "util": [0, 1, 2, 5, 8, 9, 12, 16, 17, 19, 20, 21, 22, 23, 24], "va": [1, 2, 5, 8, 9], "vae": [0, 3, 16], "valid": [1, 2, 3, 4, 5, 7, 17, 18], "validate_multi": [7, 8], "validation_batch_count": 0, "validationdata": 7, "valu": [0, 1, 2, 5, 8, 9, 16, 19, 21, 22, 23], "valueerror": 4, "var": [1, 2, 12, 26], "var_ax": [1, 2, 5, 8, 9], "var_in": 26, "var_out": 26, "varc": 12, "vari": [1, 2, 5, 8, 9], "variabl": [0, 1, 2, 5, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24], "varianc": [0, 1, 2, 5, 8, 9, 17], "variant": 16, "variat": [0, 3, 7, 16, 19], "varx": [1, 2, 5, 8, 9], "varxm": [1, 2, 5, 8, 9], "varym": [1, 2, 5, 8, 9], "ve": [13, 15, 18], "vector": [0, 3, 16], "veri": 23, "version": [3, 11, 22], "vertic": 21, "via": 11, "virtu": 16, "vmax": [1, 2, 5, 8, 9, 22, 26], "vmin": [1, 2, 5, 8, 9, 22, 26], "vname": [1, 2, 5, 8, 9], "vulner": 11, "wa": 10, "wai": [11, 13, 14, 16], "want": [3, 13, 14, 15, 16], "warn": [1, 2, 7, 8, 9, 17, 20, 23], "wasn": 1, "wcssp": 10, "we": [0, 1, 2, 3, 4, 6, 8, 9, 13, 14, 16, 17, 18, 20, 23], "weak": [], "weather": 10, "web": [], "webp": [1, 2, 5, 8, 9], "weight": [0, 1, 2, 5, 6, 7, 8, 9, 21, 22, 23], "weights_dir": 0, "well": 16, "were": [1, 10, 16], "what": [3, 6, 15, 16], "whatev": [15, 22], "when": [1, 11, 16, 18], "where": [0, 1, 2, 5, 7, 8, 9, 12, 13, 16, 17, 26], "which": [3, 16, 26], "whole": [13, 15, 16], "wide": 10, "width": 23, "width_ratio": [1, 2, 5, 8, 9], "wiki": [], "wikipedia": [], "without": 5, "won": [1, 2], "work": [3, 10, 11, 12, 16, 18, 21, 24], "world": 16, "worth": [16, 23], "would": 16, "wratio": [1, 2, 5, 8, 9], "write": [0, 7, 10, 11, 19, 20], "write_fil": [19, 20], "written": 10, "wspace": [1, 2, 5, 8, 9], "www": 3, "x": [0, 1, 2, 4, 5, 8, 9, 17, 26], "x86": 11, "x_i": 23, "x_img": [1, 2, 5, 8, 9], "x_max": 23, "x_min": 23, "x_offset": 23, "xdata": 26, "xlabel": 26, "xmargin": 23, "xmax": [24, 26], "xmin": [24, 26], "xpoint": 1, "y": [1, 2, 5, 8, 9, 26], "y_i": 23, "y_offset": 23, "yaml": [], "ydata": 26, "year": [1, 2, 4, 5, 6, 8, 9, 12, 14, 17, 19, 20, 22, 23], "ylabel": 26, "ymargin": 23, "ymax": [1, 2, 5, 8, 9, 24, 26], "ymaxl": [1, 2, 5, 8, 9], "ymin": [1, 2, 5, 8, 9, 24, 26], "yminl": [1, 2, 5, 8, 9], "yml": 11, "you": [2, 4, 9, 11, 13, 15, 16, 17, 18], "your": [3, 11, 15, 16], "yourself": 16, "ypad": [1, 2, 5, 8, 9], "ypoint": 1, "z": [0, 1, 2, 5, 8, 9], "zero": [0, 16, 17, 24, 26], "zip": [0, 4, 15, 17], "zorder": [1, 2, 5, 8, 9, 21, 22, 23, 26]}, "titles": ["Default model fixed structure", "Default model - make time-series by assimilating all test months into trained model", "Default model - assimilate test data for a single month into trained model", "Default model", "Make the tf.data.Dataset inputs and outputs for the DCVAE", "Default model - plot training history", "Generic model specification file", "Default model training script", "Default model - validate trained model on time-series of all test months", "Default model - validate trained model on test data for a single month", "Authors and acknowledgements", "Setting up the software environment", "ERA5 data download and access", "Get the data to be used", "Land mask download", "How to reproduce and extend this work", "A DIY Machine Learning Climate Model", "Estimate normalization parameters for ERA5 data", "Normalizing training data", "Assemble ERA5 normalized data into a set of tf.tensors", "Assemble ERA5 raw data into a set of tf.tensors", "Check gamma parameters for ERA5 data", "Check normalization of ERA5 data", "Check gamma distributions for ERA5 data", "Define a standard grid", "Utility functions for plotting and re-gridding", "Plotting utilities"], "titleterms": {"A": 16, "access": 12, "acknowledg": 10, "all": [1, 8], "appendic": 16, "assembl": [19, 20], "assimil": [1, 2], "author": 10, "autoencod": [], "background": 16, "base": [], "check": [21, 22, 23], "climat": 16, "conclus": 16, "convolut": [], "cross": [], "data": [2, 4, 9, 12, 13, 16, 17, 18, 19, 20, 21, 22, 23], "dataset": 4, "dcvae": 4, "decis": 16, "deep": [], "default": [0, 1, 2, 3, 5, 7, 8, 9], "defin": 24, "design": 16, "dii": 16, "distribut": 23, "download": [12, 14], "environ": 11, "era5": [12, 17, 19, 20, 21, 22, 23], "estim": 17, "extend": 15, "file": 6, "fix": 0, "function": 25, "gamma": [21, 23], "gener": [6, 16], "get": 13, "grid": [24, 25], "histori": 5, "how": 15, "input": 4, "land": 14, "learn": 16, "machin": 16, "make": [1, 4], "mask": 14, "model": [0, 1, 2, 3, 5, 6, 7, 8, 9, 16], "month": [1, 2, 8, 9], "next": 16, "normal": [17, 18, 19, 22], "output": 4, "paramet": [17, 21], "plot": [5, 25, 26], "print": 16, "raw": 20, "re": 25, "region": [], "reproduc": 15, "script": 7, "seri": [1, 8], "set": [11, 19, 20], "singl": [2, 9], "small": 16, "softwar": 11, "specif": 6, "standard": 24, "step": 16, "structur": 0, "tensor": [19, 20], "test": [1, 2, 8, 9], "tf": [4, 19, 20], "thi": 15, "time": [1, 8], "train": [1, 2, 5, 7, 8, 9, 16, 18], "up": 11, "us": [13, 16], "util": [25, 26], "valid": [8, 9, 16], "variat": [], "work": 15}})