<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Normalizing training data &#8212; An ML Climate Model based on a DCVAE</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxdoc.css?v=87629129" />
    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Assemble ERA5 raw data into a set of tf.tensors" href="make_raw_tensors.html" />
    <link rel="prev" title="Land mask download" href="../get_data/land_mask.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="make_raw_tensors.html" title="Assemble ERA5 raw data into a set of tf.tensors"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../get_data/land_mask.html" title="Land mask download"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DCVAE-Climate</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Normalizing training data</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="normalizing-training-data">
<h1>Normalizing training data<a class="headerlink" href="#normalizing-training-data" title="Link to this heading">¶</a></h1>
<figure class="align-center" id="id1" style="width: 95%">
<a class="reference internal image-reference" href="../_images/monthly_precip_1969_03.png"><img alt="../_images/monthly_precip_1969_03.png" src="../_images/monthly_precip_1969_03.png" style="width: 95%;" /></a>
<figcaption>
<p><span class="caption-text">Raw precipitation (top) and normalized equivalent (bottom) for a month.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="../get_data/index.html"><span class="doc">Downloading the data</span></a> has provided us with data in netCDF files. To use these data for ML, we need to convert them into tensors. This is done by the functions in the ‘make_raw tensors’ directory.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="make_raw_tensors.html">Assemble the raw data into tensors</a></li>
</ul>
</div>
<p>We now have data in the right format (tensors), but it’s not ready for model training. To model the data with ML, we need to make the data have two properties:</p>
<ol class="arabic simple">
<li><p>All variables should be on the same scale - around the range 0-1.</p></li>
<li><p>The data at each month and grid point should be similarly distributed. (Essentially this makes the ML model distribute its attention instead of focusing on the most variable points.)</p></li>
</ol>
<p>To do this we transform the data to have a normal distribution with mean 0.5 and standard deviation 0.2. This is done by:
#. Fitting a gamma distribution to the data. A different distribution is fit for each month and grid point.
#. For each data point, we find the cumulative distribution function (CDF) of the gamma distribution for its month and grid location, and then find the inverse CDF of the normal distribution. This gives us the normalized data.</p>
<p>The first stage is to fit the gamma distributions. This is done by functions in the ‘normalize’ directory. Run these steps in this order:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="estimate_parameters.html">Estimate normalization parameters from the raw data tensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="validate_for_points.html">Validate the gamma fits for selected points</a></li>
<li class="toctree-l1"><a class="reference internal" href="validate_for_fields.html">Validate the gamma fits for selected months</a></li>
<li class="toctree-l1"><a class="reference internal" href="validate_for_month.html">Validating normalization will work for a selected month</a></li>
</ul>
</div>
<p>When you’ve calculated all the normalization parameters. The next step is to make the normalized data. This means combining the raw data tensors with the normalization parameters to make the normalized data tensors:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="make_normalized_tensors.html"> Assemble the normalized data</a></li>
</ul>
</div>
<p>After all that, we have normalized data in the right format. We’re ready to start training a model.</p>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/DCVAE_Climate.webp" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ML_default/index.html">Detailed specification of the ML model</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_data/index.html">How to download the training data</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to convert and normalize the data</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ML_default/specify.html">Specify the details of the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ML_default/make_dataset.html">Assemble the normalized data into training and test datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ML_default/training.html">Train the model</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">Utility functions for plotting and regridding</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../how_to.html">How to reproduce or extend this work</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Authors and acknowledgements</a></li>
</ul>
<h3><a href="https://github.com/philip-brohan/DCVAE_Climate">Get a copy</a></h3>

<ul>
    <li><a href="https://github.com/philip-brohan/DCVAE_Climate" rel="nofollow">Github repository</a></li>
</ul>

<h3>Found a bug, or have a suggestion?</h3>

Please <a href="https://github.com/philip-brohan/DCVAE_Climate/issues/new">raise an issue</a>.
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="make_raw_tensors.html" title="Assemble ERA5 raw data into a set of tf.tensors"
             >next</a> |</li>
        <li class="right" >
          <a href="../get_data/land_mask.html" title="Land mask download"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DCVAE-Climate</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Normalizing training data</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    </div>
  </body>
</html>